.386
EXTERN STU:BYTE
EXTERN MENU:NEAR
PUBLIC SUB2

STACK2  SEGMENT  USE16  PARA STACK 'STACK'
       DB  256  DUP(0)
STACK2  ENDS

DATA   SEGMENT USE16 PARA PUBLIC 'D1'

SPUT2	DB	0AH,0DH,6 DUP(0),'This is SUB2.:Calculate!',0AH,0DH,'$'
SP2_1	DB	0AH,0DH,0AH,0DH,6 DUP(0),'Calculate succeed!plause any key to the menu',0AH,0DH,6 DUP(0),'$'
PUT5	DB	0AH,0DH,6 DUP(0),'Enter succeed!plause any key to the menu',0AH,0DH,6 DUP(0),'$'
DATA	ENDS

CODE SEGMENT USE16 PARA PUBLIC 'C1'
	ASSUME DS:DATA,CS:CODE,SS:STACK2
SUB2 PROC
IO		MACRO A,B
		LEA DX,A
		MOV AH,B
		INT 21H
		ENDM

;计算平均分

		MOV AX,0003H;清屏
		INT 10H
		IO SPUT2,9;输出提示符

		MOV CX,5
		LEA EBX,STU
S00:	PUSH EBX
		MOV DWORD PTR EAX,DS:[EBX+10];the  grade -> AL
		SHL EAX,1
		MOVZX DX,AL
		SHL DX,1
		MOVZX BX,AH
		ADD BX,DX
		SHR EAX,17
		XOR AH,AH
		ADD AX,BX
		MOV BL,7
		DIV BL
		
		POP EBX
		ADD EBX,16
		MOV DS:[EBX-3],AL;restore the average grade
		LOOP S00

		IO PUT5,9
		IO PUT5,1

		JMP MENU

		RET
SUB2 ENDP
CODE ENDS
	END
